<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notion Clone</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            display: flex;
            height: 100vh;
            overflow: hidden;
            background: #ffffff;
            color: #37352f;
        }

        /* Sidebar */
        .sidebar {
            width: 260px;
            background: #f7f6f3;
            border-right: 1px solid #e9e9e7;
            display: flex;
            flex-direction: column;
            transition: all 0.3s;
        }

        .sidebar.collapsed {
            width: 0;
            overflow: hidden;
        }

        .sidebar-header {
            padding: 12px 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            border-bottom: 1px solid #e9e9e7;
        }

        .workspace-name {
            font-weight: 600;
            font-size: 14px;
            flex: 1;
        }

        .sidebar-content {
            flex: 1;
            overflow-y: auto;
            padding: 8px;
        }

        .sidebar-item {
            padding: 6px 8px;
            border-radius: 3px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 14px;
            color: #37352f;
            margin-bottom: 2px;
            transition: background 0.2s;
            position: relative;
        }

        .sidebar-item:hover {
            background: rgba(55, 53, 47, 0.08);
        }

        .sidebar-item.active {
            background: rgba(55, 53, 47, 0.08);
        }

        .sidebar-item-icon {
            font-size: 18px;
            width: 22px;
            text-align: center;
        }

        .add-page-btn {
            margin: 8px;
            padding: 8px;
            border: none;
            background: transparent;
            color: #37352f99;
            cursor: pointer;
            border-radius: 3px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: background 0.2s;
        }

        .add-page-btn:hover {
            background: rgba(55, 53, 47, 0.08);
        }

        .delete-page-btn {
            position: absolute;
            right: 8px;
            padding: 4px 8px;
            background: #eb5757;
            color: white;
            border: none;
            border-radius: 3px;
            font-size: 11px;
            opacity: 0;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        .sidebar-item:hover .delete-page-btn {
            opacity: 1;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .topbar {
            height: 45px;
            border-bottom: 1px solid #e9e9e7;
            display: flex;
            align-items: center;
            padding: 0 20px;
            gap: 12px;
        }

        .toggle-sidebar {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 18px;
            color: #37352f99;
            padding: 4px 8px;
            border-radius: 3px;
            transition: background 0.2s;
        }

        .toggle-sidebar:hover {
            background: rgba(55, 53, 47, 0.08);
        }

        .breadcrumb {
            font-size: 14px;
            color: #37352f99;
        }

        .editor-container {
            flex: 1;
            overflow-y: auto;
            padding: 60px 96px;
            max-width: 100%;
        }

        .page-icon {
            font-size: 78px;
            margin-bottom: 8px;
            cursor: pointer;
            display: inline-block;
            line-height: 1;
        }

        .page-title {
            font-size: 40px;
            font-weight: 700;
            border: none;
            outline: none;
            width: 100%;
            background: transparent;
            margin-bottom: 12px;
            color: #37352f;
            resize: none;
            overflow: hidden;
            line-height: 1.2;
            font-family: inherit;
        }

        .page-title::placeholder {
            color: #37352f3d;
        }

        .block-container {
            margin-bottom: 4px;
        }

        .block {
            min-height: 28px;
            padding: 3px 2px;
            position: relative;
            display: flex;
            align-items: flex-start;
            gap: 4px;
        }

        .block:hover .block-controls {
            opacity: 1;
        }

        .block-controls {
            display: flex;
            gap: 4px;
            opacity: 0;
            transition: opacity 0.2s;
            position: absolute;
            left: -60px;
            top: 3px;
        }

        .block-control-btn {
            width: 24px;
            height: 24px;
            border: none;
            background: transparent;
            cursor: pointer;
            border-radius: 3px;
            font-size: 14px;
            color: #37352f99;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }

        .block-control-btn:hover {
            background: rgba(55, 53, 47, 0.08);
        }

        .block-content {
            flex: 1;
            min-height: 28px;
        }

        .block-input {
            width: 100%;
            border: none;
            outline: none;
            background: transparent;
            font-size: 16px;
            line-height: 1.5;
            color: #37352f;
            resize: none;
            overflow: hidden;
            font-family: inherit;
            padding: 3px 2px;
        }

        .block-input::placeholder {
            color: #37352f3d;
        }

        /* Block Types */
        .block.heading1 .block-input {
            font-size: 30px;
            font-weight: 700;
            line-height: 1.2;
            margin: 12px 0 8px;
        }

        .block.heading2 .block-input {
            font-size: 24px;
            font-weight: 700;
            line-height: 1.2;
            margin: 10px 0 6px;
        }

        .block.heading3 .block-input {
            font-size: 20px;
            font-weight: 700;
            line-height: 1.2;
            margin: 8px 0 4px;
        }

        .block.bullet .block-content::before {
            content: '•';
            margin-right: 8px;
            color: #37352f;
        }

        .block.numbered {
            counter-increment: list-counter;
        }

        .block.numbered .block-content::before {
            content: counter(list-counter) '.';
            margin-right: 8px;
            color: #37352f;
        }

        .block.todo {
            display: flex;
            align-items: flex-start;
        }

        .todo-checkbox {
            width: 18px;
            height: 18px;
            margin-right: 8px;
            margin-top: 3px;
            cursor: pointer;
        }

        .block.quote .block-input {
            border-left: 3px solid #37352f;
            padding-left: 14px;
            font-size: 16px;
            font-style: italic;
        }

        .block.code .block-input {
            font-family: 'Courier New', monospace;
            background: #f7f6f3;
            padding: 12px;
            border-radius: 3px;
            font-size: 14px;
            white-space: pre;
            overflow-x: auto;
        }

        .block.divider {
            border-top: 1px solid #e9e9e7;
            margin: 8px 0;
            height: 1px;
        }

        /* Slash Command Menu */
        .slash-menu {
            position: absolute;
            background: white;
            border: 1px solid #e9e9e7;
            border-radius: 3px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
            min-width: 280px;
            max-height: 400px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }

        .slash-menu.active {
            display: block;
        }

        .slash-menu-item {
            padding: 8px 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: background 0.2s;
        }

        .slash-menu-item:hover,
        .slash-menu-item.selected {
            background: rgba(55, 53, 47, 0.08);
        }

        .slash-menu-icon {
            font-size: 20px;
            width: 28px;
            text-align: center;
        }

        .slash-menu-text {
            flex: 1;
        }

        .slash-menu-title {
            font-size: 14px;
            color: #37352f;
            margin-bottom: 2px;
        }

        .slash-menu-desc {
            font-size: 12px;
            color: #37352f99;
        }

        /* Database View */
        .database-container {
            margin: 20px 0;
            border: 1px solid #e9e9e7;
            border-radius: 3px;
            overflow: hidden;
        }

        .database-header {
            display: flex;
            background: #f7f6f3;
            border-bottom: 1px solid #e9e9e7;
        }

        .database-cell {
            padding: 8px 12px;
            font-size: 14px;
            font-weight: 600;
            flex: 1;
            border-right: 1px solid #e9e9e7;
        }

        .database-cell:last-child {
            border-right: none;
        }

        .database-row {
            display: flex;
            border-bottom: 1px solid #e9e9e7;
        }

        .database-row:last-child {
            border-bottom: none;
        }

        .database-row:hover {
            background: rgba(55, 53, 47, 0.03);
        }

        .database-input {
            width: 100%;
            border: none;
            outline: none;
            background: transparent;
            padding: 8px 12px;
            font-size: 14px;
            flex: 1;
        }

        .add-row-btn {
            padding: 8px 12px;
            border: none;
            background: transparent;
            color: #37352f99;
            cursor: pointer;
            font-size: 14px;
            text-align: left;
            transition: background 0.2s;
        }

        .add-row-btn:hover {
            background: rgba(55, 53, 47, 0.08);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #37352f99;
        }

        .empty-state h2 {
            font-size: 24px;
            margin-bottom: 12px;
            color: #37352f;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 240px;
            }
            
            .editor-container {
                padding: 40px 24px;
            }
        }
    </style>
</head>
<body>
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="workspace-name">📝 My Workspace</div>
        </div>
        <div class="sidebar-content" id="sidebarContent">
            <!-- Pages will be added here -->
        </div>
        <button class="add-page-btn" onclick="createNewPage()">
            <span>+</span>
            <span>New Page</span>
        </button>
    </div>

    <div class="main-content">
        <div class="topbar">
            <button class="toggle-sidebar" onclick="toggleSidebar()">☰</button>
            <div class="breadcrumb" id="breadcrumb">Workspace</div>
        </div>
        
        <div class="editor-container" id="editorContainer">
            <div class="empty-state">
                <h2>Welcome to Your Workspace</h2>
                <p>Create a new page to get started</p>
            </div>
        </div>
    </div>

    <div class="slash-menu" id="slashMenu"></div>

    <script>
        // Data structure
        let pages = [];
        let currentPage = null;
        let slashMenuVisible = false;
        let slashMenuTarget = null;
        let selectedSlashIndex = 0;

        // Slash commands
        const slashCommands = [
            { icon: '📝', title: 'Text', desc: 'Just start writing with plain text', type: 'text' },
            { icon: '📄', title: 'Page', desc: 'Embed a sub-page inside this page', type: 'page' },
            { icon: 'H1', title: 'Heading 1', desc: 'Big section heading', type: 'heading1' },
            { icon: 'H2', title: 'Heading 2', desc: 'Medium section heading', type: 'heading2' },
            { icon: 'H3', title: 'Heading 3', desc: 'Small section heading', type: 'heading3' },
            { icon: '•', title: 'Bulleted list', desc: 'Create a simple bulleted list', type: 'bullet' },
            { icon: '1.', title: 'Numbered list', desc: 'Create a list with numbering', type: 'numbered' },
            { icon: '☑', title: 'To-do list', desc: 'Track tasks with a to-do list', type: 'todo' },
            { icon: '💬', title: 'Quote', desc: 'Capture a quote', type: 'quote' },
            { icon: '—', title: 'Divider', desc: 'Visually divide blocks', type: 'divider' },
            { icon: '</>', title: 'Code', desc: 'Capture a code snippet', type: 'code' },
            { icon: '📊', title: 'Table', desc: 'Add a table database', type: 'table' }
        ];

        // Initialize
        loadData();
        renderSidebar();

        // Sidebar functions
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('collapsed');
        }

        function createNewPage() {
            const page = {
                id: Date.now(),
                icon: '📄',
                title: 'Untitled',
                blocks: [
                    { id: Date.now() + 1, type: 'text', content: '' }
                ],
                created: new Date().toISOString()
            };
            pages.push(page);
            saveData();
            renderSidebar();
            openPage(page.id);
        }

        function deletePage(pageId, event) {
            event.stopPropagation();
            if (confirm('Delete this page?')) {
                pages = pages.filter(p => p.id !== pageId);
                saveData();
                renderSidebar();
                if (currentPage && currentPage.id === pageId) {
                    currentPage = null;
                    showEmptyState();
                }
            }
        }

        function renderSidebar() {
            const container = document.getElementById('sidebarContent');
            
            if (pages.length === 0) {
                container.innerHTML = '<div style="padding: 20px; text-align: center; color: #37352f99; font-size: 14px;">No pages yet</div>';
                return;
            }

            container.innerHTML = pages.map(page => `
                <div class="sidebar-item ${currentPage && currentPage.id === page.id ? 'active' : ''}" 
                     onclick="openPage(${page.id})">
                    <span class="sidebar-item-icon">${page.icon}</span>
                    <span>${escapeHtml(page.title)}</span>
                    <button class="delete-page-btn" onclick="deletePage(${page.id}, event)">×</button>
                </div>
            `).join('');
        }

        function openPage(pageId) {
            currentPage = pages.find(p => p.id === pageId);
            if (!currentPage) return;
            
            renderPage();
            renderSidebar();
            document.getElementById('breadcrumb').textContent = currentPage.title;
        }

        function showEmptyState() {
            const container = document.getElementById('editorContainer');
            container.innerHTML = `
                <div class="empty-state">
                    <h2>Welcome to Your Workspace</h2>
                    <p>Create a new page to get started</p>
                </div>
            `;
        }

        // Page rendering
        function renderPage() {
            if (!currentPage) return;

            const container = document.getElementById('editorContainer');
            container.innerHTML = `
                <div class="page-icon" onclick="changeIcon()">${currentPage.icon}</div>
                <textarea class="page-title" 
                          placeholder="Untitled" 
                          oninput="updatePageTitle(this); autoResize(this)"
                          onkeydown="handleTitleKeydown(event)">${currentPage.title}</textarea>
                <div id="blocksContainer"></div>
            `;

            // Auto-resize title
            const titleArea = container.querySelector('.page-title');
            autoResize(titleArea);

            renderBlocks();
        }

        function renderBlocks() {
            const container = document.getElementById('blocksContainer');
            if (!container || !currentPage) return;

            container.innerHTML = currentPage.blocks.map((block, index) => {
                if (block.type === 'divider') {
                    return `<div class="block divider" data-index="${index}"></div>`;
                }

                if (block.type === 'table') {
                    return renderTableBlock(block, index);
                }

                const isTodo = block.type === 'todo';
                const placeholder = getPlaceholder(block.type, index);

                return `
                    <div class="block-container">
                        <div class="block ${block.type}" data-index="${index}">
                            <div class="block-controls">
                                <button class="block-control-btn" onclick="deleteBlock(${index})">🗑️</button>
                                <button class="block-control-btn" onclick="moveBlockUp(${index})">↑</button>
                                <button class="block-control-btn" onclick="moveBlockDown(${index})">↓</button>
                            </div>
                            <div class="block-content">
                                ${isTodo ? `<input type="checkbox" class="todo-checkbox" ${block.checked ? 'checked' : ''} onchange="toggleTodo(${index})">` : ''}
                                <textarea class="block-input" 
                                          placeholder="${placeholder}"
                                          oninput="updateBlock(${index}, this.value); autoResize(this)"
                                          onkeydown="handleBlockKeydown(event, ${index})"
                                          onfocus="currentBlockIndex = ${index}">${escapeHtml(block.content)}</textarea>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            // Auto-resize all textareas
            container.querySelectorAll('textarea').forEach(autoResize);
        }

        function renderTableBlock(block, index) {
            if (!block.rows) {
                block.rows = [
                    { id: Date.now(), cells: ['', '', ''] }
                ];
            }

            return `
                <div class="block-container">
                    <div class="block" data-index="${index}">
                        <div class="block-controls">
                            <button class="block-control-btn" onclick="deleteBlock(${index})">🗑️</button>
                        </div>
                        <div class="block-content" style="width: 100%;">
                            <div class="database-container">
                                <div class="database-header">
                                    <div class="database-cell">Name</div>
                                    <div class="database-cell">Status</div>
                                    <div class="database-cell">Notes</div>
                                </div>
                                ${block.rows.map((row, rowIndex) => `
                                    <div class="database-row">
                                        ${row.cells.map((cell, cellIndex) => `
                                            <input type="text" 
                                                   class="database-input" 
                                                   value="${escapeHtml(cell)}"
                                                   oninput="updateTableCell(${index}, ${rowIndex}, ${cellIndex}, this.value)">
                                        `).join('')}
                                    </div>
                                `).join('')}
                                <button class="add-row-btn" onclick="addTableRow(${index})">+ New</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function getPlaceholder(type, index) {
            if (index === 0 && type === 'text') return "Type '/' for commands...";
            const placeholders = {
                text: "Type '/' for commands...",
                heading1: 'Heading 1',
                heading2: 'Heading 2',
                heading3: 'Heading 3',
                bullet: 'List item',
                numbered: 'List item',
                todo: 'To-do',
                quote: 'Quote',
                code: 'Code'
            };
            return placeholders[type] || "Type '/' for commands...";
        }

        // Block operations
        function updateBlock(index, value) {
            currentPage.blocks[index].content = value;
            saveData();

            // Check for slash command
            if (value === '/') {
                showSlashMenu(index);
            } else if (slashMenuVisible) {
                hideSlashMenu();
            }
        }

        function updateTableCell(blockIndex, rowIndex, cellIndex, value) {
            currentPage.blocks[blockIndex].rows[rowIndex].cells[cellIndex] = value;
            saveData();
        }

        function addTableRow(blockIndex) {
            const block = currentPage.blocks[blockIndex];
            block.rows.push({
                id: Date.now(),
                cells: ['', '', '']
            });
            saveData();
            renderBlocks();
        }

        function deleteBlock(index) {
            if (currentPage.blocks.length === 1) return;
            currentPage.blocks.splice(index, 1);
            saveData();
            renderBlocks();
        }

        function moveBlockUp(index) {
            if (index === 0) return;
            const block = currentPage.blocks[index];
            currentPage.blocks.splice(index, 1);
            currentPage.blocks.splice(index - 1, 0, block);
            saveData();
            renderBlocks();
        }

        function moveBlockDown(index) {
            if (index === currentPage.blocks.length - 1) return;
            const block = currentPage.blocks[index];
            currentPage.blocks.splice(index, 1);
            currentPage.blocks.splice(index + 1, 0, block);
            saveData();
            renderBlocks();
        }

        function toggleTodo(index) {
            currentPage.blocks[index].checked = !currentPage.blocks[index].checked;
            saveData();
        }

        function handleBlockKeydown(event, index) {
            const textarea = event.target;
            
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                createNewBlock(index);
            } else if (event.key === 'Backspace' && textarea.value === '' && currentPage.blocks.length > 1) {
                event.preventDefault();
                deleteBlock(index);
            } else if (event.key === 'ArrowDown' && slashMenuVisible) {
                event.preventDefault();
                navigateSlashMenu(1);
            } else if (event.key === 'ArrowUp' && slashMenuVisible) {
                event.preventDefault();
                navigateSlashMenu(-1);
            } else if (event.key === 'Enter' && slashMenuVisible) {
                event.preventDefault();
                selectSlashCommand();
            } else if (event.key === 'Escape' && slashMenuVisible) {
                hideSlashMenu();
            }
        }

        function handleTitleKeydown(event) {
            if (event.key === 'Enter') {
                event.preventDefault();
                // Focus first block
                const firstBlock = document.querySelector('.block-input');
                if (firstBlock) firstBlock.focus();
            }
        }

        function createNewBlock(afterIndex) {
            const newBlock = {
                id: Date.now(),
                type: 'text',
                content: ''
            };
            currentPage.blocks.splice(afterIndex + 1, 0, newBlock);
            saveData();
            renderBlocks();
            
            // Focus new block
            setTimeout(() => {
                const blocks = document.querySelectorAll('.block-input');
                if (blocks[afterIndex + 1]) {
                    blocks[afterIndex + 1].focus();
                }
            }, 0);
        }

        // Slash menu
        function showSlashMenu(blockIndex) {
            slashMenuTarget = blockIndex;
            slashMenuVisible = true;
            selectedSlashIndex = 0;

            const menu = document.getElementById('slashMenu');
            menu.innerHTML = slashCommands.map((cmd, index) => `
                <div class="slash-menu-item ${index === 0 ? 'selected' : ''}" 
                     onclick="applySlashCommand('${cmd.type}')"
                     data-index="${index}">
                    <span class="slash-menu-icon">${cmd.icon}</span>
                    <div class="slash-menu-text">
                        <div class="slash-menu-title">${cmd.title}</div>
                        <div class="slash-menu-desc">${cmd.desc}</div>
                    </div>
                </div>
            `).join('');

            // Position menu
            const block = document.querySelector(`[data-index="${blockIndex}"]`);
            const rect = block.getBoundingClientRect();
            menu.style.top = (rect.bottom + window.scrollY) + 'px';
            menu.style.left = rect.left + 'px';
            menu.classList.add('active');
        }

        function hideSlashMenu() {
            slashMenuVisible = false;
            document.getElementById('slashMenu').classList.remove('active');
        }

        function navigateSlashMenu(direction) {
            selectedSlashIndex = (selectedSlashIndex + direction + slashCommands.length) % slashCommands.length;
            
            const items = document.querySelectorAll('.slash-menu-item');
            items.forEach((item, index) => {
                item.classList.toggle('selected', index === selectedSlashIndex);
            });
        }

        function selectSlashCommand() {
            const command = slashCommands[selectedSlashIndex];
            applySlashCommand(command.type);
        }

        function applySlashCommand(type) {
            if (slashMenuTarget === null) return;

            const block = currentPage.blocks[slashMenuTarget];
            block.type = type;
            block.content = '';
            
            if (type === 'divider') {
                block.content = '';
            }

            if (type === 'table') {
                block.rows = [
                    { id: Date.now(), cells: ['', '', ''] }
                ];
            }

            if (type === 'todo') {
                block.checked = false;
            }

            hideSlashMenu();
            saveData();
            renderBlocks();

            // Focus the block
            setTimeout(() => {
                const blocks = document.querySelectorAll('.block-input');
                if (blocks[slashMenuTarget] && type !== 'divider') {
                    blocks[slashMenuTarget].focus();
                }
            }, 0);
        }

        // Page operations
        function updatePageTitle(textarea) {
            currentPage.title = textarea.value || 'Untitled';
            saveData();
            renderSidebar();
            document.getElementById('breadcrumb').textContent = currentPage.title;
        }

        function changeIcon() {
            const icons = ['📄', '📝', '📋', '📌', '📁', '💡', '🎯', '✅', '🔖', '📊', '🎨', '🚀', '💻', '📱', '⚡'];
            const currentIndex = icons.indexOf(currentPage.icon);
            const nextIndex = (currentIndex + 1) % icons.length;
            currentPage.icon = icons[nextIndex];
            saveData();
            renderPage();
            renderSidebar();
        }

        // Utility functions
        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = textarea.scrollHeight + 'px';
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Data persistence
        function saveData() {
            window.notionData = { pages };
        }

        function loadData() {
            if (window.notionData) {
                pages = window.notionData.pages || [];
            }
        }

        // Close slash menu when clicking outside
        document.addEventListener('click',